## {{ cookiecutter.project_title }}

> {{ cookiecutter.project_short_description }}

## Table of content

- [Quick Start](#quick-start)
- [Developer Installation](#developer-installation)
- [Development Tasks](#development-tasks)
    - [Build project artifacts](#build-project-artifacts)
    - [Run tests](#run-tests)
    - [Visualize test coverage](#visualize-test-coverage)
    - [Run typechecking](#run-typechecking)
    - [Run linter](#run-linter)
    - [Format source code](#format-source-code)
    - [Serve the documentation](#serve-the-documentation)
- [Git Flow](#git-flow)
- [Git Commits](#git-commits)
- [Changelog](#changelog)

## Quick start

### Installing the project

Users can install project from github using `pip`:

```console
pip install {{cookiecutter.project_name}}@git+{{cookiecutter.repo_url}}.git
```

Confirm that project is installed correctly by importing the version string:

```python
from {{ cookiecutter.project_import }} import __version__
print(__version__)
```

## Developer installation

This project is packaged using [setuptools](https://setuptools.pypa.io/en/latest/userguide/pyproject_config.html) and a [pyproject.toml](./pyproject.toml) according to [PEP 621](https://peps.python.org/pep-0621/).

> Starting with [PEP 621](https://peps.python.org/pep-0621/), the Python community selected `pyproject.toml` as a standard way of specifying python projects metadata. Setuptools has adopted this standard and use the information contained in this file as an input in the build process.

### Install using script

Run the `install.py` script located in the `scripts/` directory with the Python interpreter of your choice. The script accepts two arguments:

- `-e` or `--extras`: a string of comma-separated extras such as `"dev,doc"`.
- `-a` or `--all`: a boolean flag indicating that all extras should be installed.

Example usage:

- Install with build extra only (default behaviour)

```console
python3 scripts/install.py
```

- Install some extras only

```console
python3 scripts/install.py --extras build,dev
```

- Install all extras

```console
python3 scripts/install.py --all
```

> Note: The `venv` module must be installed for the python interpreter used to run install script. On Debian and Ubuntu systems, this package can be installed using the following command: `sudo apt-get install python3-venv`. On Windows systems, python distributions have the `venv` module installed by default.

### Install manually

In order to install the project manually, follow those steps:

1. Create a virtual environment:

```console
python3 -m venv .venv
```

2. Activate the virtual environment:

```console
source .venv/bin/activate
```

3.  Update `pip`, `setuptools` and `wheel` packages within virtual environment:

```console
pip install -U pip setuptools wheel
```

4. Install the project in [development mode](https://setuptools.pypa.io/en/latest/userguide/development_mode.html):

```console
pip install -e .[dev,doc]
```

5. Check that project is installed:

```console
pip list
```


## Development tasks

The file [`tasks.py`](./tasks.py) is an [invoke]() [task file](). It describes several tasks which developers can execute to perform various actions.

To list all available tasks, activate the project virtual environment, and run the command `inv --list`:

```console
$ inv --list

Available tasks:

  all
  build       Build sdist and wheel, and optionally build documentation.
  check       Run mypy typechecking.
  clean       Clean build artifacts and optionally documentation artifacts as well as generated bytecode.
  coverage    Serve code coverage results and optionally run tests before serving results
  docs        Serve the documentation in development mode.
  format      Format source code using black and isort.
  lint        Lint source code using flake8.
  test        Run tests using pytest and optionally enable coverage.
  wheelhouse  Build wheelhouse for the project.
```

### Build project artifacts

The `build` task can be used to build a [source distribution (`sdist`)](https://docs.python.org/fr/3/distutils/sourcedist.html), a [wheel binary package](https://peps.python.org/pep-0427/) by default.

Optionally, it can be used to build the project documentation as a static website.

Usage:

- Build `sdist` and `wheel` only:

```console
inv build
```

- Build `sdist`, `wheel` and documentation:

```console
inv build --docs
```

### Building wheelhouse

The `wheelhouse` task can be used to generate an [installation bundle](https://pip.pypa.io/en/stable/topics/repeatable-installs/#using-a-wheelhouse-aka-installation-bundles) also known as a wheelhouse.

> pip wheel can be used to generate and package all of a projectâ€™s dependencies, with all the compilation performed, into a single directory that can be converted into a single archive. This archive then allows installation when index servers are unavailable and avoids time-consuming recompilation.

This command does not accept any argument, and generates the wheelhouse into `dist/wheelhouse`.

### Run tests

The `test` task can be used to run tests using `pytest`.

By default, test coverage is not enabled and `-c` or `--coverage` option must be provided to enable test coverage.

Usage:

- Run tests without coverage:

```console
inv test
```

- Run tests with coverage:

```console
inv test --coverage
```

### Visualize test coverage

The `coverage` task can be used to serve test coverage results on `http://localhost:8000` by default. Use `--port` option to use a different port.

By default, test coverage is expected to be present before running the task. If it is desired to run tests before serving the results, use `--run` option.

### Run typechecking

The `check` task can be used to run [`mypy`](https://mypy.readthedocs.io/en/stable/).

By default type checking is not run on tests and `-i` or `--include-tests` option must be provided to include them.

### Run linter

The `lint` task can be used to lint source code using [`flake8`](https://flake8.pycqa.org/en/latest/). This task does not accept any option.

> `flake8` is configured in the [setup.cfg](./setup.cfg) file.

### Format source code

The `format` task can be used to format source code using [`black`](https://black.readthedocs.io/en/stable/) and [`isort`](https://isort.readthedocs.io/en/latest/). This task does not accept any option.

> `black` is not configured in any way, but `isort` is configured in [setup.cfg](./setup.cfg).

### Serve the documentation

The `docs` task can be used to serve the documentation as a static website on <http://localhost:8000> with auto-reload enabled by default. Use the `--port` option to change the listenning port and the `--no-watch` to disable auto-reload.

## Git flow

Two branches exist:

- `next`: The development branch. All developers must merge commits to `next` through Pull Requests.

- `main`: The release branch. Developers must not commit to this branch. Only merge from `next` branch with fast-forward strategy are allowed on `main` branch. 

> Each time new commits are pushed on `main`, semantic-release may perform a release bump according to commit messages.

## Git commits 

Developers are execpted to write commit messages according to the [Convetionnal Commits](https://www.conventionalcommits.org/en/v1.0.0/) specification.

> Commit messages which are not valid conventionnal commits are ignored in changelog.

## Changelog

Changelog is generated for each release candidate and each release according to commit messages found since last release.

Changelog content is written to [`CHANGELOG.md`](./CHANGELOG.md) by [@semantic-release/release-notes-generator](https://github.com/semantic-release/release-notes-generator) plugin configured with [`conventionnalcommit`](https://www.conventionalcommits.org/en/v1.0.0/) preset.

## Contributing to the documentation

Project documentation is written using [MkDocs](https://www.mkdocs.org/) static site generator. Documentation source files are written in [Markdown](https://docs.github.com/fr/get-started/writing-on-github/getting-started-with-writing-and-formatting-on-github/basic-writing-and-formatting-syntax). They can be found in [docs/](./docs/) directory.

Aside from documentation written in markdown files, Python API reference is generated from docstrings and type annotations found in source code.
